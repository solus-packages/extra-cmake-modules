From cecf126e34e8285bfd2fc48ca54eb611ece3d945 Mon Sep 17 00:00:00 2001
From: Peter O'Connor <sunnyflunk@gmail.com>
Date: Mon, 12 Dec 2016 20:24:26 +1100
Subject: [PATCH] Enable stateless paths

Set default place files in /usr/share/xdg
    - correct placement for xdg and xdg/autostart
    - use absolute paths for compatibility
Use better libexec dir /usr/share/kf5 for KF5
---
 kde-modules/KDEInstallDirs.cmake | 14 ++++----------
 1 file changed, 4 insertions(+), 10 deletions(-)

diff --git a/kde-modules/KDEInstallDirs.cmake b/kde-modules/KDEInstallDirs.cmake
index 7f5e447..37ca14e 100644
--- a/kde-modules/KDEInstallDirs.cmake
+++ b/kde-modules/KDEInstallDirs.cmake
@@ -425,10 +425,10 @@ if(WIN32)
         LIBEXEC_INSTALL_DIR)
     _define_non_cache(LIBEXECDIR_KF5 "${CMAKE_INSTALL_LIBEXECDIR}")
 else()
-    _define_relative(LIBEXECDIR LIBDIR "libexec"
+    _define_relative(LIBEXECDIR LIBDIR "kf5"
         "executables for internal use by programs and libraries"
         LIBEXEC_INSTALL_DIR)
-    _define_non_cache(LIBEXECDIR_KF5 "${CMAKE_INSTALL_LIBEXECDIR}/kf5")
+    _define_non_cache(LIBEXECDIR_KF5 "${CMAKE_INSTALL_LIBEXECDIR}")
 endif()
 if(NOT KDE_INSTALL_DIRS_NO_DEPRECATED)
     set(KF5_LIBEXEC_INSTALL_DIR "${CMAKE_INSTALL_LIBEXECDIR_KF5}")
@@ -592,16 +592,10 @@ _define_relative(DBUSSYSTEMSERVICEDIR DBUSDIR "system-services"



-set(_default_sysconf_dir "etc")
-if (CMAKE_INSTALL_PREFIX STREQUAL "/usr")
-    set(_default_sysconf_dir "/etc")
-endif()
-
-
-_define_absolute(SYSCONFDIR "${_default_sysconf_dir}"
+_define_absolute(SYSCONFDIR "/etc"
     "read-only single-machine data"
     SYSCONF_INSTALL_DIR)
-_define_relative(CONFDIR SYSCONFDIR "xdg"
+_define_absolute(CONFDIR "/usr/share/xdg"
     "application configuration files"
     CONFIG_INSTALL_DIR)
 _define_relative(AUTOSTARTDIR CONFDIR "autostart"
--
2.11.0
